<div class="voca_main">
  <ul
    class="nav nav-tabs nav-fill mb-3"
    id="myTab2"
    role="tablist"
  >
    <li class="nav-item" role="presentation">
      <button
        class="nav-link active"
        id="folder-tab2"
        data-bs-toggle="tab"
        data-bs-target="#folder-tab-pane2"
        type="button"
        role="tab"
        aria-controls="folder-tab-pane2"
        aria-selected="true"
      >
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-folder2-open" viewBox="0 0 16 16">
        <path d="M1 3.5A1.5 1.5 0 0 1 2.5 2h2.764c.958 0 1.76.56 2.311 1.184C7.985 3.648 8.48 4 9 4h4.5A1.5 1.5 0 0 1 15 5.5v.64c.57.265.94.876.856 1.546l-.64 5.124A2.5 2.5 0 0 1 12.733 15H3.266a2.5 2.5 0 0 1-2.481-2.19l-.64-5.124A1.5 1.5 0 0 1 1 6.14V3.5zM2 6h12v-.5a.5.5 0 0 0-.5-.5H9c-.964 0-1.71-.629-2.174-1.154C6.374 3.334 5.82 3 5.264 3H2.5a.5.5 0 0 0-.5.5V6zm-.367 1a.5.5 0 0 0-.496.562l.64 5.124A1.5 1.5 0 0 0 3.266 14h9.468a1.5 1.5 0 0 0 1.489-1.314l.64-5.124A.5.5 0 0 0 14.367 7H1.633z"/>
      </svg>
        공유 폴더
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button
        class="nav-link"
        id="file-tab2"
        data-bs-toggle="tab"
        data-bs-target="#file-tab-pane2"
        type="button"
        role="tab"
        aria-controls="file-tab-pane2"
        aria-selected="false"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          fill="currentColor"
          class="bi bi-journal-text"
          viewBox="0 0 16 16"
        >
          <path
            d="M5 10.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"
          />
          <path
            d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"
          />
          <path
            d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"
          />
        </svg>
        공유 단어장
      </button>
    </li>
  </ul>
  <div class="tab-content sha_tab" id="myTabContent2">
    <div
      class="tab-pane fade show active"
      id="folder-tab-pane2"
      role="tabpanel"
      aria-labelledby="folder-tab2"
      tabindex="0"
    >
      <div class="container-fluid">
        <div class="voca_file_list row row-cols-auto" id="sha_fd_area">
          <% for(i=0;i<folder.length;i++){ %>
            <div class="dropdown m-2">
              <button type="button" class="btn dropdown-toggle sha_voca_folder" data-bs-toggle="dropdown" aria-expanded="false" onclick="loadMoreSha('<%= folder[i].folder_id %>','<%- i %>')">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-folder" viewBox="0 0 16 16">
                    <path d="M.54 3.87.5 3a2 2 0 0 1 2-2h3.672a2 2 0 0 1 1.414.586l.828.828A2 2 0 0 0 9.828 3h3.982a2 2 0 0 1 1.992 2.181l-.637 7A2 2 0 0 1 13.174 14H2.826a2 2 0 0 1-1.991-1.819l-.637-7a1.99 1.99 0 0 1 .342-1.31zM2.19 4a1 1 0 0 0-.996 1.09l.637 7a1 1 0 0 0 .995.91h10.348a1 1 0 0 0 .995-.91l.637-7A1 1 0 0 0 13.81 4H2.19zm4.69-1.707A1 1 0 0 0 6.172 2H2.5a1 1 0 0 0-1 .981l.006.139C1.72 3.042 1.95 3 2.19 3h5.396l-.707-.707z"/>
                  </svg>
                  <span class="text-wrap" ><%= folder[i].folder_name %></span>
                <div class="sh_fd_user">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16">
                    <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                    <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
                  </svg>
                  <span id="sh_fd_user<%- i %>"></span>
                </div>
              </button>
              <ul class="dropdown-menu">
                <li class="text-center">
                  폴더 내 단어장 목록
                </li>
                <div id="drop_sha_fav<%- i %>">
                </div>
              </ul>
            </div>
            <script>
              fetch("/voca/shared_user",{
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify({
                  user_id: '<%= folder[i].user_id %>',
                }),
              })
              .then((res) => res.json())
              .then((nick) => {
                document.getElementById('sh_fd_user<%- i %>').innerText = nick.nickname
              })
            </script>
          <%}%>
        </div>
      </div>
    </div>
    <div
      class="tab-pane fade"
      id="file-tab-pane2"
      role="tabpanel"
      aria-labelledby="file-tab2"
      tabindex="0"
    >
      <div class="container-fluid text-center">
        <div class="voca_file_list row row-cols-auto" id="sha_fl_area">
          <% for(i=0;i<file.length;i++){ %>
            <div class="sha_voca_file text-center m-2">                    
              <div class="sha_fileTitle">
                <div>
                  <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  fill="currentColor"
                  class="bi bi-journal-text"
                  viewBox="0 0 16 16"
                  >
                    <path
                      d="M5 10.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"
                    />
                    <path
                      d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"
                    />
                    <path
                      d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"
                    />
                  </svg>
                  <%= file[i].file_name %>
                </div>
              </div>
              <div class="sh_fl_user">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16">
                  <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                  <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
                </svg>
                <span id='sh_fl_user<%- i %>'>
                </span>
              </div>
              <div class="filebtnRow">
                <form action="/voca/shared_voca_load" method="post" name="loadingvoca">
                  <input type="hidden" name="fl_id" value="<%= file[i].file_id %>" />
                  <input type="hidden" name="fl_name" value="<%= file[i].file_name %>" />
                  <input type="submit" class="btn btn-outline-secondary file_btn" value="열기" />
                </form>
                <form action="/voca/shared_voca_study" method="post" name="loadingvoca">
                  <input type="hidden" name="fl_id" value="<%= file[i].file_id %>" />
                  <input type="hidden" name="fl_name" value="<%= file[i].file_name %>" />
                  <input type="submit" class="btn btn-outline-secondary file_btn" value="공부" />
                </form>
              </div>
            </div>
            <script>
              fetch("/voca/shared_user",{
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify({
                  user_id: '<%= file[i].user_id %>',
                }),
              })
              .then((res) => res.json())
              .then((nick) => {
                document.getElementById('sh_fl_user<%- i %>').innerText = nick.nickname
              })
            </script>
          <% } %>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  window.onresize = () => {
    if (window.innerWidth < 480) {
      document
        .getElementById("sha_fl_area")
        .classList.remove("row", "row-cols-auto");
    }else{
      document
        .getElementById("sha_fl_area")
        .classList.add("row", "row-cols-auto");
    }
  }

  const loadMoreSha = (fd_id, i) => {
    fetch("/voca/load_sha_file", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        fd_id: fd_id,
      }),
    })
      .then((res) => res.json())
      .then((list) => {
        let sha_filelist = "";
        for (let i = 0; i < list.length; i++) {
          sha_filelist += `
          <li><hr class="dropdown-divider"></li>
          <li>
            <form action="/voca/shared_voca_load" method="post" name="loadingvoca">
              <input type="hidden" name="fl_id" value="${list[i].file_id}" />
              <input type="hidden" name="fl_name" value="${list[i].file_name}" />
              <button class="dropdown-item" type="submit">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-journal-text" viewBox="0 0 16 16">
                  <path d="M5 10.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"/>
                  <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"/>
                  <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"/>
                </svg>
              ${list[i].file_name}
              </button>
            </form>
          </li>
          
          `;
        }
        document.getElementById("drop_sha_fav" + i).innerHTML = sha_filelist;
      });
  };
</script>